<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Pastebin</title>
</head>
<body>
  <h1>Pastebin</h1>
  <form id="pasteForm">
    <textarea id="pasteText" rows="10" cols="50"></textarea>
    <br>
    <button type="submit">Create Paste</button>
  </form>

  <div id="pastes"></div>

  <script>
    const pasteForm = document.getElementById('pasteForm');
    const pasteText = document.getElementById('pasteText');
    const pastesDiv = document.getElementById('pastes');

    pasteForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const pasteContent = pasteText.value;
      const pasteData = {
        content: pasteContent,
      };

      try {
        const response = await fetch('/api/createPaste.js', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(pasteData),
        });

        if (response.ok) {
          const pasteId = await response.text();
          window.location.href = `/paste/${pasteId}`;
        } else {
          throw new Error('Error creating paste');
        }
      } catch (error) {
        console.error('Error:', error);
      }
    });

    // Function to fetch and display pastes
    async function displayPastes() {
      try {
        const response = await fetch('/api/getPastes.js');
        const pastes = await response.json();

        pastesDiv.innerHTML = '';

        pastes.forEach((paste) => {
          const pasteElement = document.createElement('div');
          pasteElement.innerHTML = `
            <h3>${paste.id}</h3>
            <pre>${paste.content}</pre>
          `;
          pastesDiv.appendChild(pasteElement);
        });
      } catch (error) {
        console.error('Error:', error);
      }
    }

    // Initial call to display pastes
    displayPastes();
  </script>
</body>
</html>
